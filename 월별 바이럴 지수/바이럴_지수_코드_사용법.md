# ğŸ“˜ ë°”ì´ëŸ´ ì§€ìˆ˜ ê³„ì‚° ì½”ë“œ ì‚¬ìš© ê°€ì´ë“œ

## ğŸ“ íŒŒì¼ ì •ë³´

**íŒŒì¼ëª…**: `calculate_viral_index.py`

**ê¸°ëŠ¥**: ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ëœ ë‰´ìŠ¤ ë°ì´í„°ì—ì„œ ì›”ë³„ ë°”ì´ëŸ´ ì§€ìˆ˜ë¥¼ ìë™ ê³„ì‚°

**ì¶œë ¥**:
1. `2025_viral_index_top3.csv` - ì›”ë³„ TOP 3 ë°”ì´ëŸ´ ì¹´í…Œê³ ë¦¬
2. `2025_viral_index_matrix.csv` - ì „ì²´ ë°”ì´ëŸ´ ì§€ìˆ˜ ë§¤íŠ¸ë¦­ìŠ¤

---

## ğŸ”§ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬

```bash
pip install pandas numpy openpyxl
```

- **pandas**: ë°ì´í„° ì²˜ë¦¬
- **numpy**: ìˆ˜ì¹˜ ê³„ì‚°
- **openpyxl**: Excel íŒŒì¼ ì½ê¸°

---

## ğŸš€ ì‚¬ìš© ë°©ë²•

### ë°©ë²• 1: ê¸°ë³¸ ì‹¤í–‰

```bash
python calculate_viral_index.py
```

**ì „ì œ ì¡°ê±´**:
- í˜„ì¬ ë””ë ‰í† ë¦¬ì— `news_2025_full_categorized.xlsx` íŒŒì¼ì´ ìˆì–´ì•¼ í•¨

### ë°©ë²• 2: ì½”ë“œì—ì„œ ì§ì ‘ í˜¸ì¶œ

```python
from calculate_viral_index import calculate_viral_index

# í•¨ìˆ˜ í˜¸ì¶œ
viral_top3, viral_matrix = calculate_viral_index(
    input_file='news_2025_full_categorized.xlsx',
    output_dir='./'
)

# ê²°ê³¼ í™•ì¸
print(viral_top3.head())
print(viral_matrix.head())
```

### ë°©ë²• 3: ê²½ë¡œ ì»¤ìŠ¤í„°ë§ˆì´ì§•

ì½”ë“œ ë‚´ë¶€ `main()` í•¨ìˆ˜ ìˆ˜ì •:

```python
def main():
    # ì…ë ¥ íŒŒì¼ ê²½ë¡œ ìˆ˜ì •
    input_file = '/path/to/your/news_data.xlsx'
    
    # ì¶œë ¥ ë””ë ‰í† ë¦¬ ìˆ˜ì •
    output_dir = '/path/to/output/'
    
    viral_top3, viral_matrix = calculate_viral_index(input_file, output_dir)
```

---

## ğŸ“Š ì…ë ¥ íŒŒì¼ í˜•ì‹

**í•„ìˆ˜ ì»¬ëŸ¼**:
1. `ì¹´í…Œê³ ë¦¬` - ë‰´ìŠ¤ ì¹´í…Œê³ ë¦¬ (ì˜ˆ: "ì£¼ì‹íˆ¬ì/íŠ¸ë ˆì´ë”©", "í…Œí¬/ìŠ¤íƒ€íŠ¸ì—…" ë“±)
2. `ë…„ì›”` - ë‚ ì§œ ì •ë³´ (í˜•ì‹: "2025-01", "2025-02" ë“±)

**ì˜ˆì‹œ ë°ì´í„°**:

| ì œëª© | ì¼ì | ì¹´í…Œê³ ë¦¬ | ë…„ì›” |
|------|------|----------|------|
| ì‚¼ì„±ì „ì ì‹¤ì  ë°œí‘œ | 2025-01-15 | ì£¼ì‹íˆ¬ì/íŠ¸ë ˆì´ë”© | 2025-01 |
| AI ë°˜ë„ì²´ ì—´í’ | 2025-10-20 | í…Œí¬/ìŠ¤íƒ€íŠ¸ì—… | 2025-10 |
| ... | ... | ... | ... |

**ì£¼ì˜ì‚¬í•­**:
- "ë¯¸ë¶„ë¥˜" ì¹´í…Œê³ ë¦¬ëŠ” ìë™ìœ¼ë¡œ ì œì™¸ë¨
- `ë…„ì›”` ì»¬ëŸ¼ì´ ì—†ìœ¼ë©´ `ì¼ì` ì»¬ëŸ¼ì—ì„œ ìë™ ìƒì„± ê°€ëŠ¥ (ì½”ë“œ ìˆ˜ì • í•„ìš”)

---

## ğŸ“ˆ ë°”ì´ëŸ´ ì§€ìˆ˜ ê³„ì‚° ë°©ë²•

### ê³µì‹

```
ë°”ì´ëŸ´ ì§€ìˆ˜ = (MoM ì¦ê°€ìœ¨ Ã— 50%) 
            + (3ê°œì›” í‰ê·  ëŒ€ë¹„ í¸ì°¨ Ã— 30%) 
            + (Z-Score Ã— 20%)
```

### êµ¬ì„± ìš”ì†Œ

1. **MoM (Month-over-Month) ì¦ê°€ìœ¨**
   ```python
   mom_growth = count_df.pct_change() * 100
   ```
   - ì „ì›” ëŒ€ë¹„ ì¦ê°ë¥ 
   - ì˜ˆ: 100ê°œ â†’ 150ê°œ = +50%

2. **3ê°œì›” ì´ë™í‰ê·  ëŒ€ë¹„ í¸ì°¨**
   ```python
   ma3 = count_df.rolling(window=3, min_periods=1).mean()
   ma_deviation = ((count_df - ma3) / ma3) * 100
   ```
   - ìµœê·¼ 3ê°œì›” í‰ê· ê³¼ ë¹„êµ
   - ë‹¨ê¸° íŠ¸ë Œë“œ ë³€í™” í¬ì°©

3. **Z-Score (í‘œì¤€í™”)**
   ```python
   z_scores = (count_df - count_df.mean()) / count_df.std()
   ```
   - ì „ì²´ ë°ì´í„° ëŒ€ë¹„ ì´ìƒì¹˜ íƒì§€
   - -3 ~ +3 ë²”ìœ„ (20 ê³±í•´ì„œ ìŠ¤ì¼€ì¼ ì¡°ì •)

### í•´ì„

- **ì–‘ìˆ˜**: í‰ì†Œë³´ë‹¤ ë§ì´ ì–¸ê¸‰ë¨ (ë°”ì´ëŸ´ ì¤‘!)
- **ìŒìˆ˜**: í‰ì†Œë³´ë‹¤ ì ê²Œ ì–¸ê¸‰ë¨
- **0**: í‰ê·  ìˆ˜ì¤€
- **20 ì´ìƒ**: ë§¤ìš° í•«í•¨ ğŸ”¥
- **-20 ì´í•˜**: ë§¤ìš° ì¿¨í•¨ â„ï¸

---

## ğŸ“¤ ì¶œë ¥ íŒŒì¼ ì„¤ëª…

### 1. 2025_viral_index_top3.csv

**ë‚´ìš©**: ì›”ë³„ ë°”ì´ëŸ´ ì§€ìˆ˜ TOP 3 ì¹´í…Œê³ ë¦¬

**ì»¬ëŸ¼**:
- `ë…„ì›”`: í•´ë‹¹ ì›” (ì˜ˆ: "2025-01")
- `ìˆœìœ„`: 1, 2, 3
- `ì¹´í…Œê³ ë¦¬`: ì¹´í…Œê³ ë¦¬ëª…
- `ë°”ì´ëŸ´ì§€ìˆ˜`: ê³„ì‚°ëœ ë°”ì´ëŸ´ ì§€ìˆ˜
- `ì‹¤ì œê¸°ì‚¬ìˆ˜`: í•´ë‹¹ ì›” ì‹¤ì œ ê¸°ì‚¬ ê°œìˆ˜
- `ì „ì›”ëŒ€ë¹„`: ì „ì›” ëŒ€ë¹„ ì¦ê°ë¥  (ì˜ˆ: "+50.0%")
- `MoMì¦ê°€ìœ¨`: MoM ì„±ë¶„ê°’
- `MAëŒ€ë¹„í¸ì°¨`: MAí¸ì°¨ ì„±ë¶„ê°’
- `Z-Score`: Z-Score ì„±ë¶„ê°’

**ì˜ˆì‹œ**:
```csv
ë…„ì›”,ìˆœìœ„,ì¹´í…Œê³ ë¦¬,ë°”ì´ëŸ´ì§€ìˆ˜,ì‹¤ì œê¸°ì‚¬ìˆ˜,ì „ì›”ëŒ€ë¹„,MoMì¦ê°€ìœ¨,MAëŒ€ë¹„í¸ì°¨,Z-Score
2025-02,1,ê²½ì œì´ë¡ /í•™ìˆ ,90.1,32,+146.2%,146.2,55.3,2.15
2025-03,1,íˆ¬ìì² í•™/ëŒ€ê°€,78.6,103,+102.0%,102.0,48.2,1.89
...
```

### 2. 2025_viral_index_matrix.csv

**ë‚´ìš©**: ì „ì²´ ì›” x ì¹´í…Œê³ ë¦¬ ë°”ì´ëŸ´ ì§€ìˆ˜ ë§¤íŠ¸ë¦­ìŠ¤

**í˜•ì‹**:
```csv
,ê±°ì‹œê²½ì œ/ê¸ˆìœµì •ì±…,ê²½ì œì´ë¡ /í•™ìˆ ,ê¸ˆìœµì‹œìŠ¤í…œ/ìœ„ê¸°,...
2025-01,9.9,-15.3,-8.2,...
2025-02,-22.1,90.1,2.5,...
...
```

**ì‚¬ìš©ì²˜**:
- íˆíŠ¸ë§µ ì‹œê°í™”
- ì¹´í…Œê³ ë¦¬ë³„ íŠ¸ë Œë“œ ë¶„ì„
- ìƒê´€ê´€ê³„ ë¶„ì„

---

## ğŸ¨ ê²°ê³¼ ì‹œê°í™” ì˜ˆì‹œ

### íˆíŠ¸ë§µ ìƒì„±

```python
import matplotlib.pyplot as plt
import seaborn as sns

# ë§¤íŠ¸ë¦­ìŠ¤ ë¡œë“œ
viral_matrix = pd.read_csv('2025_viral_index_matrix.csv', index_col=0)

# íˆíŠ¸ë§µ
plt.figure(figsize=(12, 8))
sns.heatmap(viral_matrix.T, cmap='RdBu_r', center=0, 
            annot=True, fmt='.0f', cbar_kws={'label': 'Viral Index'})
plt.title('Monthly Viral Index Heatmap')
plt.xlabel('Month')
plt.ylabel('Category')
plt.tight_layout()
plt.savefig('viral_heatmap.png', dpi=300)
```

### ì›”ë³„ TOP 1 ë§‰ëŒ€ ê·¸ë˜í”„

```python
# TOP 3 ë°ì´í„° ë¡œë“œ
viral_top3 = pd.read_csv('2025_viral_index_top3.csv')

# 1ìœ„ë§Œ í•„í„°ë§
top1 = viral_top3[viral_top3['ìˆœìœ„'] == 1]

# ë§‰ëŒ€ ê·¸ë˜í”„
plt.figure(figsize=(12, 6))
colors = ['#ff4444' if x > 30 else '#ff8844' if x > 20 else '#ffaa44' 
          for x in top1['ë°”ì´ëŸ´ì§€ìˆ˜']]
plt.bar(range(len(top1)), top1['ë°”ì´ëŸ´ì§€ìˆ˜'], color=colors)
plt.xticks(range(len(top1)), top1['ë…„ì›”'].str.split('-').str[1])
plt.ylabel('Viral Index')
plt.title('Monthly #1 Viral Category')
plt.axhline(y=20, color='red', linestyle='--', alpha=0.5)
plt.grid(axis='y', alpha=0.3)
plt.tight_layout()
plt.savefig('monthly_top1.png', dpi=300)
```

---

## ğŸ” ì½”ë“œ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### ê°€ì¤‘ì¹˜ ë³€ê²½

ê¸°ë³¸ ê°€ì¤‘ì¹˜ë¥¼ ë³€ê²½í•˜ë ¤ë©´:

```python
# ê¸°ì¡´ (50%, 30%, 20%)
viral_index = (
    mom_growth.fillna(0) * 0.5 + 
    ma_deviation.fillna(0) * 0.3 + 
    z_scores.fillna(0) * 20 * 0.2
)

# ì˜ˆ: MoM ì¤‘ì‹œ (70%, 20%, 10%)
viral_index = (
    mom_growth.fillna(0) * 0.7 + 
    ma_deviation.fillna(0) * 0.2 + 
    z_scores.fillna(0) * 20 * 0.1
)
```

### ì´ë™í‰ê·  ê¸°ê°„ ë³€ê²½

3ê°œì›” â†’ 6ê°œì›”ë¡œ ë³€ê²½:

```python
# ê¸°ì¡´
ma3 = count_df.rolling(window=3, min_periods=1).mean()

# 6ê°œì›”
ma6 = count_df.rolling(window=6, min_periods=1).mean()
ma_deviation = ((count_df - ma6) / ma6) * 100
```

### TOP 5ë¡œ í™•ì¥

TOP 3 â†’ TOP 5:

```python
# ê¸°ì¡´
for rank, (cat, viral_score) in enumerate(month_viral.head(3).items(), 1):

# TOP 5ë¡œ ë³€ê²½
for rank, (cat, viral_score) in enumerate(month_viral.head(5).items(), 1):
```

---

## âš ï¸ ë¬¸ì œ í•´ê²°

### ì˜¤ë¥˜ 1: íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ

```
FileNotFoundError: news_2025_full_categorized.xlsx
```

**í•´ê²°**:
- íŒŒì¼ ê²½ë¡œ í™•ì¸
- íŒŒì¼ëª… í™•ì¸ (ëŒ€ì†Œë¬¸ì êµ¬ë¶„)
- `main()` í•¨ìˆ˜ì—ì„œ `input_file` ê²½ë¡œ ìˆ˜ì •

### ì˜¤ë¥˜ 2: ì»¬ëŸ¼ì´ ì—†ìŒ

```
KeyError: 'ì¹´í…Œê³ ë¦¬'
```

**í•´ê²°**:
- Excel íŒŒì¼ì— 'ì¹´í…Œê³ ë¦¬', 'ë…„ì›”' ì»¬ëŸ¼ í™•ì¸
- ì»¬ëŸ¼ëª…ì´ ë‹¤ë¥´ë©´ ì½”ë“œ ìˆ˜ì •:
  ```python
  df_classified = df[df['ì¹´í…Œê³ ë¦¬ëª…'] != 'ë¯¸ë¶„ë¥˜'].copy()  # 'ì¹´í…Œê³ ë¦¬' â†’ 'ì¹´í…Œê³ ë¦¬ëª…'
  ```

### ì˜¤ë¥˜ 3: ë©”ëª¨ë¦¬ ë¶€ì¡±

**í•´ê²°**:
- ì²­í¬ ë‹¨ìœ„ë¡œ ì½ê¸°:
  ```python
  # í•œ ë²ˆì— ëª¨ë‘ ì½ê¸° (ê¸°ì¡´)
  df = pd.read_excel(input_file)
  
  # ì²­í¬ ë‹¨ìœ„ë¡œ ì½ê¸°
  chunks = pd.read_excel(input_file, chunksize=10000)
  df = pd.concat(chunks, ignore_index=True)
  ```

---

## ğŸ“š ì¶”ê°€ í™œìš© ì˜ˆì‹œ

### íŠ¹ì • ì¹´í…Œê³ ë¦¬ë§Œ ë¶„ì„

```python
# íˆ¬ìì² í•™/ëŒ€ê°€ë§Œ
investment_viral = viral_matrix['íˆ¬ìì² í•™/ëŒ€ê°€']
print(investment_viral.sort_values(ascending=False))
```

### ì›”ë³„ í‰ê·  ë°”ì´ëŸ´ ì§€ìˆ˜

```python
monthly_avg = viral_matrix.mean(axis=1)
print(monthly_avg)
```

### ì¹´í…Œê³ ë¦¬ë³„ í‰ê·  ë°”ì´ëŸ´ ì§€ìˆ˜

```python
category_avg = viral_matrix.mean(axis=0)
print(category_avg.sort_values(ascending=False))
```

---

## ğŸ’¡ í™œìš© íŒ

1. **ì²« ì‹¤í–‰ ì „ ë°ì´í„° í™•ì¸**
   ```python
   df = pd.read_excel('news_2025_full_categorized.xlsx')
   print(df.columns)  # ì»¬ëŸ¼ëª… í™•ì¸
   print(df['ì¹´í…Œê³ ë¦¬'].unique())  # ì¹´í…Œê³ ë¦¬ ëª©ë¡
   print(df['ë…„ì›”'].unique())  # ì›” ëª©ë¡
   ```

2. **ê²°ê³¼ë¥¼ Excelë¡œ ì €ì¥**
   ```python
   viral_top3.to_excel('viral_top3.xlsx', index=False)
   viral_matrix.to_excel('viral_matrix.xlsx')
   ```

3. **ë””ë²„ê¹… ëª¨ë“œ**
   - ì½”ë“œ ì¤‘ê°„ì— `print()` ì¶”ê°€
   - ê° ë‹¨ê³„ë³„ ê²°ê³¼ í™•ì¸

---

## ğŸ“ ë¬¸ì˜

ë¬¸ì œê°€ ë°œìƒí•˜ë©´:
1. ì…ë ¥ íŒŒì¼ í˜•ì‹ ì¬í™•ì¸
2. ì˜¤ë¥˜ ë©”ì‹œì§€ ì „ì²´ ë³µì‚¬
3. Python ë²„ì „ í™•ì¸ (`python --version`)
4. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ í™•ì¸ (`pip list`)

---

**Happy Analyzing! ğŸ‰**
